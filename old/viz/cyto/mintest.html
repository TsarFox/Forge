<html>
<head>
	<script type="text/javascript" src="./cytoscape.min.js"></script>

	<style type="text/css">
	#cy {
		width: 300px;
		height: 300px;
		display: block;
	}
	</style>
</head>
<body>
	<div id="cy"></div>

	<script type="text/javascript">

	var json = {
		"relations": {
			"edges": [["a", "b"], ["b", "a"], ["a", "b"]]
		},
		"nodes": ["a", "b"],
	};
	// the json above is in the format {"relations": {}, "nodes": [], "edges": []}
	// I need to make a list of nodes and a list of edges.

	// ahh shit. the nodes stuff is handy. But the edges stuff is useless, because I also always need to know the relation an edge came from.


	var nodes = json["nodes"].map(function(name){
		return {data: {id: name, label: name}}
	});

	var edges = json["relations"]["edges"].map(function(tuple){
		var start = tuple[0];
		var end = tuple[tuple.length - 1];
		var between = tuple.slice(1, tuple.length - 1);
		var label = "";
		if (between.length > 0){
			label = "->" + between.join("->") + "->";
		}

		return {
			data: {
				id: start + end,
				source: start,
				target: end,
				label: label,
			}
		}
	})

	// this needs to take a json and output a cytoscape spec.
	// so my racket needs to output a json.
/*
		[ // list of graph elements to start with
			{ // node a
				data: { id: 'a' }
			},
			{ // node b
				data: { id: 'b' }
			},
			{ // edge ab
				data: { id: 'ab', source: 'a', target: 'b' }
			}
		],*/

	// ah yes, they need to be directed and have self loops
	var cy = cytoscape({

		container: document.getElementById('cy'), // container to render in

		elements: nodes.concat(edges),

		style: [ // the stylesheet for the graph
			{
				selector: 'node',
				style: {
					'background-color': '#666',
					'label': 'data(id)'
				}
			},

			{
				selector: 'edge',
				style: {
					'width': 3,
					'line-color': '#ccc',
					'target-arrow-color': '#ccc',
					'target-arrow-shape': 'triangle'
				}
			}
		],

		layout: {
			name: 'grid',
			rows: 1
		}

	});
</script>
</body>
</html>

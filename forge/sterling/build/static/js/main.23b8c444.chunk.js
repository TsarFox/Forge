(this["webpackJsonpsterling-lite"]=this["webpackJsonpsterling-lite"]||[]).push([[0],{282:function(e,t,n){e.exports=n(489)},488:function(e,t,n){},489:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(17),s=n.n(i),c=n(104);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o=n(3),u=n(6),l=n(5),h=n(4),d=n(68),p=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(o.a)(this,n),t.call(this,"ws://localhost:"+window.location.search.slice(1))}return n}(function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this))._url=void 0,a._ws=void 0,a._auto_reconnect=void 0,a._auto_reconnect_interval=void 0,a._connected=void 0,a._heartbeat_count=void 0,a._heartbeat_id=void 0,a._heartbeat_interval=void 0,a._heartbeat_latency=void 0,a._heartbeat_timestamp=void 0,a._url=e,a._ws=null,a._auto_reconnect=!1,a._auto_reconnect_interval=5e3,a._connected=!1,a._heartbeat_count=0,a._heartbeat_id=0,a._heartbeat_interval=15e3,a._heartbeat_latency=0,a._heartbeat_timestamp=0,a}return Object(h.a)(n,[{key:"connect",value:function(){this._ws&&(this._ws.onclose=null,this._ws.close()),this._initializeConnection()}},{key:"requestContrastingCase",value:function(){return this._request("contrast")}},{key:"requestCurrentInstance",value:function(){return this._request("current")}},{key:"requestEvaluateExpression",value:function(e,t){return this._request("EVL:".concat(e,":").concat(t))}},{key:"requestNextInstance",value:function(){return this._request("next")}},{key:"_handleContrastingCase",value:function(e){var t=e.slice(0,4),n=e.slice(4);if("XML:"===t&&n.length)try{this.dispatchEvent({type:"contrast",instance:new d.a(n)})}catch(a){this.dispatchEvent({type:"error",message:"Invalid instance data"})}}},{key:"_handleEval",value:function(e){this.dispatchEvent({type:"eval",data:e})}},{key:"_handlePong",value:function(){this._heartbeat_latency+=performance.now()-this._heartbeat_timestamp,this._heartbeat_count+=1}},{key:"_handleXML",value:function(e){if(e.length)try{this.dispatchEvent({type:"instance",instance:new d.a(e)})}catch(t){this.dispatchEvent({type:"error",message:"Invalid instance data"})}}},{key:"_initializeConnection",value:function(){this._ws=new WebSocket(this._url),this._ws.onopen=this._onOpen.bind(this),this._ws.onclose=this._onClose.bind(this),this._ws.onerror=this._onError.bind(this),this._ws.onmessage=this._onMessage.bind(this)}},{key:"_onClose",value:function(e){this._connected=!1,this._ws=null,this._auto_reconnect&&this._reconnect(),this.dispatchEvent({type:"disconnect"})}},{key:"_onError",value:function(e){this.dispatchEvent({type:"error"})}},{key:"_onMessage",value:function(e){this._resetHeartbeat();var t=e.data.slice(0,4),n=e.data.slice(4);switch(t){case"pong":this._handlePong();break;case"CST:":this._handleContrastingCase(n);break;case"EVL:":this._handleEval(n);break;case"XML:":this._handleXML(n);break;default:this.dispatchEvent({type:"error",message:"Unknown response header: ".concat(t)})}}},{key:"_onOpen",value:function(e){this._connected=!0,this._resetHeartbeat(),this.dispatchEvent({type:"connect"})}},{key:"_ping",value:function(){this._ws&&(this._heartbeat_timestamp=performance.now(),this._ws.send("ping"))}},{key:"_reconnect",value:function(){window.setTimeout(this._initializeConnection.bind(this),this._auto_reconnect_interval)}},{key:"_request",value:function(e){return!(!this._connected||!this._ws)&&(this._ws.send(e),!0)}},{key:"_resetHeartbeat",value:function(){clearTimeout(this._heartbeat_id),this._heartbeat_id=window.setTimeout(this._ping.bind(this),this._heartbeat_interval)}}]),n}(function(){function e(){Object(o.a)(this,e),this._listeners=void 0}return Object(h.a)(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;return void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t),this}},{key:"dispatchEvent",value:function(e){var t=this;if(void 0===this._listeners)return this;var n=this._listeners[e.type];void 0!==n&&(e.target=this,n.slice().forEach((function(n){n.call(t,e)})));return this}},{key:"hasEventListener",value:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}},{key:"removeEventListener",value:function(e,t){if(void 0===this._listeners)return this;var n=this._listeners[e];if(void 0!==n){var a=n.indexOf(t);-1!==a&&n.splice(a,1)}return this}}]),e}())),f=n(28),v=n(130),m=n(67),_={instance:null,contrast:null,instanceGraph:new m.b,contrastGraph:new m.b},b=Object(v.a)({name:"sterling",initialState:_,reducers:{setInstance:function(e,t){e.instance=t.payload,e.contrast=null},setContrastingCase:function(e,t){e.contrast=t.payload}}}),y=b.actions,g=y.setInstance,E=y.setContrastingCase,k=b.reducer;var w=Object(f.e)(k),C=n(223),O=n(12),j=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e))._requestNext=function(){a.props.connection.requestNextInstance()},a.state={connected:!1,ready:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.connection.addEventListener("connect",(function(){e.setState({connected:!0})})).addEventListener("disconnect",(function(){e.setState({connected:!1,ready:!1})})).addEventListener("instance",(function(t){e.setState({ready:e.state.connected})}))}},{key:"render",value:function(){var e=this.state;return r.a.createElement(O.Navbar,{fixedToTop:!0,className:"nav bp3-dark"},r.a.createElement(O.Navbar.Group,null,r.a.createElement(O.NavbarHeading,{className:"nav-heading"},"Sterling ",r.a.createElement("span",{className:"muted"},"Lite")),r.a.createElement(O.NavbarDivider,null)),r.a.createElement(O.Navbar.Group,null,r.a.createElement(O.Button,{disabled:!e.ready,intent:e.connected?"success":"danger",large:!0,onClick:this._requestNext,rightIcon:"circle-arrow-right",text:"Next Instance"})))}}]),n}(r.a.Component),N=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i)))._layoutMenu=function(){return r.a.createElement(O.Menu,null,r.a.createElement(O.MenuItem,{text:"Test",icon:"lab-test"}))},e._requestContrasting=function(){e.props.connection.requestContrastingCase()},e}return Object(h.a)(n,[{key:"render",value:function(){return r.a.createElement(O.Navbar,{className:"nav",fixedToTop:!1},r.a.createElement(O.Navbar.Group,null,r.a.createElement(O.ButtonGroup,{style:{minWidth:120}},r.a.createElement(O.Popover,{minimal:!0,position:O.Position.BOTTOM_LEFT},r.a.createElement(O.Button,{rightIcon:"caret-down",fill:!0,text:"Layout Options"}),this._layoutMenu()))),this.props.canRequestContrastingCase&&r.a.createElement(O.Navbar.Group,null,r.a.createElement(O.Button,{intent:"success",outlined:!0,large:!1,text:"Generate Contrasting Case",onClick:this._requestContrasting})))}}]),n}(r.a.Component),q=n(105),I=n(29),M=n(69);var T=new Map,x=Object(I.a)(),L=Object(I.a)(),S=Object(I.a)().set("Int",!0),G=[{nodes:[],shape:{type:"circle"}}],R=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e))._ref=void 0,a._onResize=function(){a.props.graph.resize()},a._ref=r.a.createRef(),a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this._ref.current,t=this.props,n=t.instance,a=t.graph;n&&this._update(a,n),e&&a.canvas(e),a.update()}},{key:"componentDidUpdate",value:function(e,t,n){var a=this.props,r=a.instance,i=a.graph,s=this._ref.current;e.instance!==r&&null!==r&&(this._update(i,r),s&&i.canvas(s),i.update(),console.log("update"))}},{key:"render",value:function(){return this.props.instance?r.a.createElement(O.ResizeSensor,{onResize:this._onResize},r.a.createElement("canvas",{className:"graph",ref:this._ref})):r.a.createElement(O.NonIdealState,{title:"No Instance",icon:"graph"})}},{key:"_update",value:function(e,t){var n=function(e,t,n,a,r,i){var s=Object(I.a)(e.signatures().map((function(t){var n,r=t.id();return a.has(r)?[t,(n=a.get(r),e.atoms().find((function(e){return e.name()===n})))]:[t,void 0]}))),c=Object(I.a)(e.fields().map((function(e){return[e,e.tuples().map(y).filter(M.isDefined).filter(_)]}))).filter((function(e){return e.length>0})),o=Object(I.a)(e.skolems().map((function(e){return[e,e.tuples().map(y).filter(M.isDefined).filter(_)]}))).filter((function(e){return e.length>0})),u=c.filter((function(e,t){return!b(t)&&e[0].arity()>1})),l=c.filter((function(e,t){return b(t)||1===e[0].arity()})),h=o.filter((function(e){return e[0].arity()>1})),p=o.filter((function(e){return 1===e[0].arity()})),f=[],v=Object(I.b)().withMutations((function(e){function t(t,n){var a=n.atoms(),r=a[0],i=a[a.length-1],s=a.slice(1,a.length-1),c=t.name()+(s.length?" [".concat(s.join(", "),"]"):"");e.add(r),e.add(i),f.push({source:r.name(),target:i.name(),group:t.id(),label:c})}u.forEach((function(e,n){e.forEach((function(e){return t(n,e)}))})),h.forEach((function(e,n){e.forEach((function(e){return t(n,e)}))}))})),m=Object(I.a)().withMutations((function(e){function t(t,n){Object(I.a)().withMutations((function(e){t.forEach((function(t){var n=t.atoms(),a=n[0],r=n.slice(1).map((function(e){return e.name()})).join("->");e.has(a)||e.set(a,[]),r.length&&e.get(a).push(r)}))})).forEach((function(t,a){var r="field"===n.expressionType()&&!b(n),i=t.length?": ".concat(t.join(", ")):"",s="".concat(n.name()).concat(i);e.has(a)||e.set(a,[]),e.get(a).push(r?"(".concat(s,")"):s)}))}l.forEach(t),p.forEach(t)}));return[e.atoms().map((function(e){var a=e.type();if(v.has(e)||!i.get(a.id())){var r=t.find((function(t){return t.id===e.name()}))||n.get(e.name())||{id:e.name(),x:0,y:0};return r.labels=m.get(e),r}})).filter(M.isDefined),f];function _(e){return e.arity()>0}function b(e){return!!r.get(e.id())}function y(e){var t=e.types().map(g).map((function(e){return s.get(e)}));if(!t.some(M.isDefined))return e;var n=e.atoms();return n.every((function(e,n){return void 0===t[n]||t[n]===e}))?new d.b(e.id(),n.filter((function(e,n){return void 0===t[n]}))):void 0}function g(e){return e.typeHierarchy()[1]}}(t,e.nodes(),T,x,L,S),a=Object(q.a)(n,2),r=a[0],i=a[1];e.nodes(r),e.edges(i),e.axesVisible(!1),e.gridVisible(!1),e.nodeStyles(this._buildNodeStyles()),(new m.a).apply(e,{nodesep:100,rankdir:"BT",ranksep:150});var s=this._ref.current;s&&this.props.graph.canvas(s)}},{key:"_buildNodeStyles",value:function(){var e=this.props.instance;if(!e)return G;var t=e.univ();if(!t)return G;return[function e(t){var n=t.subTypes().map(e);return{nodes:t.atoms().map((function(e){return e.name()})),shape:{type:"circle",radius:25},children:n}}(t)]}}]),n}(r.a.Component),z=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this.props;return r.a.createElement("div",{className:"graph-view"},r.a.createElement(N,{connection:e.connection,canRequestContrastingCase:e.canRequestContrastingCase}),r.a.createElement(R,{instance:e.instance,graph:e.graph}))}}]),n}(r.a.Component);z._signatureTable=function(e,t){return r.a.createElement(O.HTMLTable,{key:t,className:"bp3-html-table-bordered bp3-html-table-condensed bp3-html-table-striped"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,e.name()))),r.a.createElement("tbody",null,e.atoms().map((function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e.name()))}))))},z._fieldTable=function(e,t){return r.a.createElement("div",{className:"table-container",key:t},e.name(),r.a.createElement(O.HTMLTable,{className:"bp3-html-table-bordered bp3-html-table-condensed bp3-html-table-striped"},r.a.createElement("thead",null,r.a.createElement("tr",null,e.types().map((function(e,t){return r.a.createElement("th",{key:t},e.name())})))),r.a.createElement("tbody",null,e.tuples().map((function(e,t){return r.a.createElement("tr",{key:t},e.atoms().map((function(e,t){return r.a.createElement("td",{key:t},e.name())})))})))))};var D=z,B={setInstance:g,setContrastingCase:E},H=Object(c.b)((function(e){return Object(C.a)({},e)}),B)(function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r)))._initializeConnection=function(){var t=e.props.connection;t.addEventListener("connect",(function(){t.requestCurrentInstance()})),t.addEventListener("instance",(function(t){e.props.setInstance(t.instance)})),t.addEventListener("contrast",(function(t){e.props.setContrastingCase(t.instance)})),t.connect()},e._renderStage=function(){var t=e.props,a=t.instance,r=t.instanceGraph,i=t.contrast,s=t.contrastGraph;return null===a?n._renderPlaceholder():null===i?e._renderSingleInstance(a,r):e._renderInstanceWithContrast(a,r,i,s)},e}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this._initializeConnection()}},{key:"render",value:function(){return r.a.createElement("div",{className:"sterling"},r.a.createElement(j,{connection:this.props.connection}),this._renderStage())}},{key:"_renderSingleInstance",value:function(e,t){return r.a.createElement("div",{className:"stage"},r.a.createElement(D,{canRequestContrastingCase:!0,connection:this.props.connection,instance:e,graph:t}))}},{key:"_renderInstanceWithContrast",value:function(e,t,n,a){return r.a.createElement("div",{className:"stage"},r.a.createElement(D,{canRequestContrastingCase:!0,connection:this.props.connection,instance:e,graph:t}),r.a.createElement("div",{className:"divider"}),r.a.createElement(D,{canRequestContrastingCase:!1,connection:this.props.connection,instance:n,graph:a}))}}],[{key:"_renderPlaceholder",value:function(){return r.a.createElement("div",{className:"stage placeholder"},"Generate an instance.")}}]),n}(r.a.Component)),P=(n(488),new p);s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(c.a,{store:w},r.a.createElement(H,{connection:P}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[282,1,2]]]);
//# sourceMappingURL=main.23b8c444.chunk.js.map
(this["webpackJsonpsterling-lite"]=this["webpackJsonpsterling-lite"]||[]).push([[0],{138:function(e,t,n){e.exports=n(171)},170:function(e,t,n){},171:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(15),s=n.n(r),c=n(47);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o=n(6),l=n(9),u=n(8),h=n(7),d=n(56),v=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.call(this,"ws://localhost:"+window.location.search.slice(1))}return n}(function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this))._url=void 0,a._ws=void 0,a._auto_reconnect=void 0,a._auto_reconnect_interval=void 0,a._connected=void 0,a._heartbeat_count=void 0,a._heartbeat_id=void 0,a._heartbeat_interval=void 0,a._heartbeat_latency=void 0,a._heartbeat_timestamp=void 0,a._url=e,a._ws=null,a._auto_reconnect=!1,a._auto_reconnect_interval=5e3,a._connected=!1,a._heartbeat_count=0,a._heartbeat_id=0,a._heartbeat_interval=15e3,a._heartbeat_latency=0,a._heartbeat_timestamp=0,a}return Object(h.a)(n,[{key:"connect",value:function(){this._ws&&(this._ws.onclose=null,this._ws.close()),this._initializeConnection()}},{key:"requestContrastingCase",value:function(){return this._request("contrast")}},{key:"requestCurrentInstance",value:function(){return this._request("current")}},{key:"requestEvaluateExpression",value:function(e,t){return this._request("EVL:".concat(e,":").concat(t))}},{key:"requestNextInstance",value:function(){return this._request("next")}},{key:"_handleContrastingCase",value:function(e){var t=e.slice(0,4),n=e.slice(4);if("XML:"===t&&n.length)try{this.dispatchEvent({type:"contrast",instance:new d.a(n)})}catch(a){this.dispatchEvent({type:"error",message:"Invalid instance data"})}}},{key:"_handleEval",value:function(e){this.dispatchEvent({type:"eval",data:e})}},{key:"_handlePong",value:function(){this._heartbeat_latency+=performance.now()-this._heartbeat_timestamp,this._heartbeat_count+=1}},{key:"_handleXML",value:function(e){if(e.length)try{this.dispatchEvent({type:"instance",instance:new d.a(e)})}catch(t){this.dispatchEvent({type:"error",message:"Invalid instance data"})}}},{key:"_initializeConnection",value:function(){this._ws=new WebSocket(this._url),this._ws.onopen=this._onOpen.bind(this),this._ws.onclose=this._onClose.bind(this),this._ws.onerror=this._onError.bind(this),this._ws.onmessage=this._onMessage.bind(this)}},{key:"_onClose",value:function(e){this._connected=!1,this._ws=null,this._auto_reconnect&&this._reconnect(),this.dispatchEvent({type:"disconnect"})}},{key:"_onError",value:function(e){this.dispatchEvent({type:"error"})}},{key:"_onMessage",value:function(e){this._resetHeartbeat();var t=e.data.slice(0,4),n=e.data.slice(4);switch(t){case"pong":this._handlePong();break;case"CST:":this._handleContrastingCase(n);break;case"EVL:":this._handleEval(n);break;case"XML:":this._handleXML(n);break;default:this.dispatchEvent({type:"error",message:"Unknown response header: ".concat(t)})}}},{key:"_onOpen",value:function(e){this._connected=!0,this._resetHeartbeat(),this.dispatchEvent({type:"connect"})}},{key:"_ping",value:function(){this._ws&&(this._heartbeat_timestamp=performance.now(),this._ws.send("ping"))}},{key:"_reconnect",value:function(){window.setTimeout(this._initializeConnection.bind(this),this._auto_reconnect_interval)}},{key:"_request",value:function(e){return!(!this._connected||!this._ws)&&(this._ws.send(e),!0)}},{key:"_resetHeartbeat",value:function(){clearTimeout(this._heartbeat_id),this._heartbeat_id=window.setTimeout(this._ping.bind(this),this._heartbeat_interval)}}]),n}(function(){function e(){Object(o.a)(this,e),this._listeners=void 0}return Object(h.a)(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;return void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t),this}},{key:"dispatchEvent",value:function(e){var t=this;if(void 0===this._listeners)return this;var n=this._listeners[e.type];void 0!==n&&(e.target=this,n.slice().forEach((function(n){n.call(t,e)})));return this}},{key:"hasEventListener",value:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}},{key:"removeEventListener",value:function(e,t){if(void 0===this._listeners)return this;var n=this._listeners[e];if(void 0!==n){var a=n.indexOf(t);-1!==a&&n.splice(a,1)}return this}}]),e}())),_=n(19),m=n(51),p=Object(m.a)({name:"sterling",initialState:{instance:null,contrast:null},reducers:{setInstance:function(e,t){e.instance=t.payload,e.contrast=null},setContrastingCase:function(e,t){e.contrast=t.payload}}}),b=p.actions,f=b.setInstance,E=b.setContrastingCase,y=p.reducer;var g=Object(_.e)(y),k=n(89),C=n(14),w=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e))._requestNext=function(){a.props.connection.requestNextInstance()},a.state={connected:!1,ready:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.connection.addEventListener("connect",(function(){e.setState({connected:!0})})).addEventListener("disconnect",(function(){e.setState({connected:!1,ready:!1})})).addEventListener("instance",(function(t){e.setState({ready:e.state.connected})}))}},{key:"render",value:function(){var e=this.state;return i.a.createElement(C.Navbar,{fixedToTop:!0,className:"nav bp3-dark"},i.a.createElement(C.Navbar.Group,null,i.a.createElement(C.NavbarHeading,{className:"nav-heading"},"Sterling ",i.a.createElement("span",{className:"muted"},"Lite")),i.a.createElement(C.NavbarDivider,null)),i.a.createElement(C.Navbar.Group,null,i.a.createElement(C.Button,{disabled:!e.ready,intent:e.connected?"success":"danger",large:!0,onClick:this._requestNext,rightIcon:"circle-arrow-right",text:"Next Instance"})))}}]),n}(i.a.Component),O=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r)))._layoutMenu=function(){return i.a.createElement(C.Menu,null,i.a.createElement(C.MenuItem,{text:"Test",icon:"lab-test"}))},e._requestContrasting=function(){e.props.connection.requestContrastingCase()},e}return Object(h.a)(n,[{key:"render",value:function(){return i.a.createElement(C.Navbar,{className:"nav",fixedToTop:!1},i.a.createElement(C.Navbar.Group,null,i.a.createElement(C.ButtonGroup,{style:{minWidth:120}},i.a.createElement(C.Popover,{minimal:!0,position:C.Position.BOTTOM_LEFT},i.a.createElement(C.Button,{rightIcon:"caret-down",fill:!0,text:"Layout Options"}),this._layoutMenu()))),this.props.canRequestContrastingCase&&i.a.createElement(C.Navbar.Group,null,i.a.createElement(C.Button,{intent:"success",outlined:!0,large:!1,text:"Generate Contrasting Case",onClick:this._requestContrasting})))}}]),n}(i.a.Component),j=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{className:"graph-view"},i.a.createElement(O,{connection:this.props.connection,canRequestContrastingCase:this.props.canRequestContrastingCase}),i.a.createElement("div",{className:"temp-tables"},this.props.instance.signatures().filter((function(e){return e.atoms().length})).sort((function(e,t){return e.atoms().length-t.atoms().length})).map(n._signatureTable),this.props.instance.fields().map(n._fieldTable)))}}]),n}(i.a.Component);j._signatureTable=function(e,t){return i.a.createElement(C.HTMLTable,{key:t,className:"bp3-html-table-bordered bp3-html-table-condensed bp3-html-table-striped"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,e.name()))),i.a.createElement("tbody",null,e.atoms().map((function(e,t){return i.a.createElement("tr",{key:t},i.a.createElement("td",null,e.name()))}))))},j._fieldTable=function(e,t){return i.a.createElement("div",{className:"table-container",key:t},e.name(),i.a.createElement(C.HTMLTable,{className:"bp3-html-table-bordered bp3-html-table-condensed bp3-html-table-striped"},i.a.createElement("thead",null,i.a.createElement("tr",null,e.types().map((function(e,t){return i.a.createElement("th",{key:t},e.name())})))),i.a.createElement("tbody",null,e.tuples().map((function(e,t){return i.a.createElement("tr",{key:t},e.atoms().map((function(e,t){return i.a.createElement("td",{key:t},e.name())})))})))))};var N=j,q={setInstance:f,setContrastingCase:E},L=Object(c.b)((function(e){return Object(k.a)({},e)}),q)(function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i)))._initializeConnection=function(){var t=e.props.connection;t.addEventListener("connect",(function(){t.requestCurrentInstance()})),t.addEventListener("instance",(function(t){e.props.setInstance(t.instance)})),t.addEventListener("contrast",(function(t){e.props.setContrastingCase(t.instance)})),t.connect()},e._renderStage=function(){var t=e.props,a=t.instance,i=t.contrast;return null===a?n._renderPlaceholder():null===i?e._renderSingleInstance(a):e._renderInstanceWithContrast(a,i)},e}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this._initializeConnection()}},{key:"render",value:function(){return i.a.createElement("div",{className:"sterling"},i.a.createElement(w,{connection:this.props.connection}),this._renderStage())}},{key:"_renderSingleInstance",value:function(e){return i.a.createElement("div",{className:"stage"},i.a.createElement(N,{canRequestContrastingCase:!0,connection:this.props.connection,instance:e}))}},{key:"_renderInstanceWithContrast",value:function(e,t){return i.a.createElement("div",{className:"stage"},i.a.createElement(N,{canRequestContrastingCase:!0,connection:this.props.connection,instance:e}),i.a.createElement("div",{className:"divider"}),i.a.createElement(N,{canRequestContrastingCase:!1,connection:this.props.connection,instance:t}))}}],[{key:"_renderPlaceholder",value:function(){return i.a.createElement("div",{className:"stage placeholder"},"Generate an instance.")}}]),n}(i.a.Component)),T=(n(170),new v);s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(c.a,{store:g},i.a.createElement(L,{connection:T}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[138,1,2]]]);
//# sourceMappingURL=main.84bef90a.chunk.js.map